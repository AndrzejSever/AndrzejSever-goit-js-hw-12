{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createMarkupItem = images => {\n    return images\n      .map(\n        ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n          return `\n            <li class=\"gallery-item\">\n              <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                <img\n                  class=\"gallery-image\"\n                  src=\"${webformatURL}\"\n                  alt=\"${tags}\"                />\n              </a>\n              <div class=\"small-content\">\n                <small class=\"text-body-likes\"><span class=\"text-body\">Likes:</span> <span class=\"quantity\">${likes}</span></small>\n                <small class=\"text-body-views\"><span class=\"text-body\">Views:</span> <span class=\"quantity\">${views}</span></small>\n                <small class=\"text-body-comments\"><span class=\"text-body\">Comments:</span> <span class=\"quantity\">${comments}</span></small>\n                <small class=\"text-body-downloads\"><span class=\"text-body\">Downloads:</span> <span class=\"quantity\">${downloads}</span></small>\n              </div>\n            </li>\n          `;\n        }\n      )\n      .join('');\n  };","import axios from 'axios';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '43896740-362a21d10e9d41ec216c05f15';\n\nexport const fetchPhotosByQuery = async (query, page = 1, perPage = 15) => {\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page: perPage,\n  });\n\n  try {\n    const response = await axios.get(`${BASE_URL}?${searchParams}`);\n    return response.data;\n  } catch (error) {\n    console.error(error);\n    throw error;\n  }\n};","import { createMarkupItem } from './js/render-functions.js';\nimport { fetchPhotosByQuery } from './js/pixabay-api.js';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst galleryEl = document.querySelector('.js-gallery');\nconst searchFormEl = document.querySelector('.js-search-form');\nconst loadMoreBtnEl = document.querySelector('.js-load-more');\nconst loaderEl = document.querySelector('.js-loader');\n\nlet currentPage = 1;\nlet currentQuery = '';\nconst perPage = 15;\nlet lightbox = new SimpleLightbox('.js-gallery a');\nlet totalHits = 0;\n\nfunction showError(message) {\n  iziToast.error({\n    title: 'Error',\n    message,\n    position: 'topRight',\n    timeout: 2000,\n  });\n}\n\nfunction clearGallery() {\n  galleryEl.innerHTML = '';\n}\n\nfunction toggleLoader(show) {\n  loaderEl.classList.toggle('is-hidden', !show);\n}\n\nasync function onSearchFormSubmit(event) {\n  event.preventDefault();\n  currentQuery = event.target.elements.searchKeyword.value.trim();\n\n  if (!currentQuery) {\n    clearGallery();\n    event.target.reset();\n    showError('Illegal operation');\n    return;\n  }\n\n  currentPage = 1;\n  totalHits = 0;\n  clearGallery();\n  loadMoreBtnEl.classList.add('is-hidden');\n  toggleLoader(true);\n\n  try {\n    const imagesData = await fetchPhotosByQuery(currentQuery, currentPage, perPage);\n    totalHits = imagesData.totalHits;\n\n    if (totalHits === 0) {\n      showError('Sorry, there are no images matching your search query. Please try again!');\n    } else {\n      galleryEl.innerHTML = createMarkupItem(imagesData.hits);\n      lightbox.refresh();\n\n      if (imagesData.hits.length < perPage || totalHits <= currentPage * perPage) {\n        showError(\"We're sorry, but you've reached the end of search results.\");\n      } else {\n        loadMoreBtnEl.classList.remove('is-hidden');\n      }\n    }\n  } catch (error) {\n    showError('Failed to fetch images. Please try again later.');\n  } finally {\n    event.target.reset();\n    toggleLoader(false);\n  }\n}\n\nasync function onLoadMoreClick() {\n  currentPage += 1;\n  toggleLoader(true);\n  loadMoreBtnEl.classList.add('is-hidden');\n\n  try {\n    const imagesData = await fetchPhotosByQuery(currentQuery, currentPage, perPage);\n    galleryEl.insertAdjacentHTML('beforeend', createMarkupItem(imagesData.hits));\n    lightbox.refresh();\n\n    if (imagesData.hits.length === 0 || totalHits <= currentPage * perPage) {\n      showError(\"We're sorry, but you've reached the end of search results.\");\n    } else {\n      loadMoreBtnEl.classList.remove('is-hidden');\n    }\n\n    const { height: cardHeight } = galleryEl.firstElementChild.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    showError('Failed to fetch images. Please try again later.');\n  } finally {\n    toggleLoader(false);\n  }\n}\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtnEl.addEventListener('click', onLoadMoreClick);"],"names":["createMarkupItem","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","BASE_URL","API_KEY","fetchPhotosByQuery","query","page","perPage","searchParams","axios","error","galleryEl","searchFormEl","loadMoreBtnEl","loaderEl","currentPage","currentQuery","lightbox","SimpleLightbox","totalHits","showError","message","iziToast","clearGallery","toggleLoader","show","onSearchFormSubmit","event","imagesData","onLoadMoreClick","cardHeight"],"mappings":"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"}